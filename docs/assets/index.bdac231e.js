var T=Object.defineProperty,F=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var O=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,L=(e,t)=>{for(var s in t||(t={}))P.call(t,s)&&O(e,s,t[s]);if(x)for(var s of x(t))z.call(t,s)&&O(e,s,t[s]);return e},K=(e,t)=>F(e,J(t));import{c as H,r as g,o as a,a as l,b as r,d as f,w as y,e as $,t as h,f as q,g as I,F as k,i as W,h as Y,j as D,v as w,k as b,l as A,m as M,p as N,n as R,q as U,s as m,u as G,x as Q,y as j,z as X,A as Z,B as ee,C as te,D as se,E as oe}from"./vendor.2b61d43a.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))d(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}};re();const ne=H({state(){return{user:{name:"",id:"",count:0,onlineAt:"",rooms:[],messages:[],room:""}}},mutations:{setUser(e,t){e.user=t},setUserProp(e,{prop:t,val:s}){e.user[t]=s},pushUserProps(e,{prop:t,val:s}){e.user[t].push(s)},countMessage(e){e.user.count=e.user.count+1}}}),ie={class:"fa navbar"},ae={class:"route"},le={class:"route"},ue=$("Profile");function de(e,t,s,d,i,o){const u=g("router-link");return a(),l("ul",ie,[r("li",ae,[f(u,{to:"/"},{default:y(()=>[$(h(e.roomID||"Chats"),1)]),_:1})]),r("li",le,[f(u,{to:"/user/"+e.userID},{default:y(()=>[ue]),_:1},8,["to"])])])}var p=(e,t)=>{const s=e.__vccOpts||e;for(const[d,i]of t)s[d]=i;return s};const he={};var me=p(he,[["render",de]]);function ce(e,t,s,d,i,o){const u=g("TheNavbar"),n=g("router-view");return a(),l(k,null,[e.userID?(a(),q(u,{key:0,class:"w-full mb-4"})):I("",!0),f(n,{class:"h-full"})],64)}window.addEventListener("resize",()=>{let e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`)});const _e={data:()=>({}),components:{TheNavbar:me},mounted(){if(this.lsUser)try{this.getOne("users/"+this.lsUser.id).then(e=>{this.$store.commit("setUser",e)})}catch(e){console.log(e),localStorage.removeItem("chat--user"),this.$router.push("/login")}else this.$router.push("/login")},beforeUnmount(){this.lsUser=this.$store.state.user,this.updateByKey("users/",this.userID,this.$store.state.user),window.removeEventListener("resize")}};var pe=p(_e,[["render",ce]]);const ge={apiKey:"AIzaSyD8pkb9OsLYohxINl6WKVf5G9VjgFDKRHo",authDomain:"a-little-chat.firebaseapp.com",databaseURL:"https://a-little-chat-default-rtdb.europe-west1.firebasedatabase.app",projectId:"a-little-chat",storageBucket:"a-little-chat.appspot.com",messagingSenderId:"191360084622",appId:"1:191360084622:web:cc0b9e3dd41a09879377df"};W(ge);const c=Y();var _="/assets/icon.01d8339e.svg";const B=e=>(N("data-v-6952a49c"),e=e(),R(),e),fe=_+"#loader",ve=_+"#enter",ye={key:0,class:"loader"},$e=B(()=>r("svg",{class:"w-8 h-8"},[r("use",{href:fe})],-1)),Ie=[$e],be={key:1},ke={class:"fc mb-2"},De={class:"fc mb-2"},we=B(()=>r("svg",{class:"w-4 h-4",fill:"white"},[r("use",{href:ve})],-1)),Ne=[we],Re={key:0,class:"text-center text-xl mt-8"},Ce={key:1,class:"room-list"},xe=["onClick"],Oe=["onClick"];function Le(e,t,s,d,i,o){const u=g("router-link");return e.isLoading?(a(),l("div",ye,Ie)):(a(),l("div",be,[r("div",ke,[r("button",{class:"button-ok shine md:w-[60%]",onClick:t[0]||(t[0]=(...n)=>o.createRoom&&o.createRoom(...n))},"Create")]),r("div",De,[D(r("input",{class:"input shine",placeholder:"Join private room","onUpdate:modelValue":t[1]||(t[1]=n=>e.privateID=n),onKeydown:t[2]||(t[2]=b(n=>o.joinRoom(e.privateID),["enter"]))},null,544),[[w,e.privateID]]),r("button",{onClick:t[3]||(t[3]=(...n)=>o.joinRoom&&o.joinRoom(...n))},Ne)]),e.rooms.length==0?(a(),l("h1",Re,"No rooms yet!")):(a(),l("ul",Ce,[(a(!0),l(k,null,A(e.rooms,n=>(a(),l("li",{class:"room shine cursor-pointer",onClick:M(C=>o.joinRoom(n.id),["self"])},[r("span",{class:"mr-1",onClick:M(C=>o.joinRoom(n.id),["self"])},h(n.id)+" by",9,Oe),f(u,{class:"underline",to:"/user/"+n.admin.id},{default:y(()=>[$(h(n.admin.name.name),1)]),_:2},1032,["to"])],8,xe))),256))]))]))}const Ke={data:()=>({rooms:[],privateID:"",isLoading:!1}),computed:{},methods:{getRooms(){this.isLoading=!0,U(m(c,"rooms"),e=>{let t=e.val();t&&(this.rooms=Object.keys(t).filter(s=>t[s]._info.private==!1||Object.keys(t[s]._info.users).includes(this.userID)).map(s=>({id:s,admin:{name:Object.values(t[s]._info.users)[0],id:Object.keys(t[s]._info.users)[0]}})))}),this.isLoading=!1},createRoom(){let e=this.add("rooms/",{_info:{name:"",users:{[this.userID]:{name:this.userName}},private:!1}});this.add("rooms/"+e,{text:"Hi there\u{1F525}",userID:this.userID,userName:this.userName}),this.add("users/"+this.userID+"/rooms/",e),this.$router.push(`/room/${e}`)},joinRoom(e){this.setOne("rooms/"+e+"/_info/users/",this.userID,{name:this.userName}).then(this.$router.push("/room/"+e))}},mounted(){this.getRooms()}};var Ae=p(Ke,[["render",Le],["__scopeId","data-v-6952a49c"]]);const Me=e=>(N("data-v-7929dd13"),e=e(),R(),e),Ue={class:"flex justify-center mt-12 h-8"},je={class:"relative"},Be=Me(()=>r("label",{class:"name",for:"name"},"Name",-1));function Se(e,t,s,d,i,o){return a(),l("div",Ue,[r("div",je,[Be,D(r("input",{class:"input shine",id:"name","onUpdate:modelValue":t[0]||(t[0]=u=>e.name=u),placeholder:"Enter name",onKeydown:t[1]||(t[1]=b((...u)=>o.enter&&o.enter(...u),["enter"]))},null,544),[[w,e.name]])]),r("button",{class:"button-ok shine w-12",onClick:t[2]||(t[2]=(...u)=>o.enter&&o.enter(...u))},"Join")])}const Ee={data:()=>({name:""}),methods:{enter(){const e=this.getKey("users");this.$store.commit("setUser",{id:e,name:this.name,onlineAt:new Date,rooms:[],count:0}),this.updateByKey("users/",e,this.$store.state.user),this.lsUser=this.$store.state.user,this.$router.push("/")}}};var Ve=p(Ee,[["render",Se],["__scopeId","data-v-7929dd13"]]);const Te={class:"fcc"},Fe={class:"flex text-left"},Je=r("div",{class:"w-24 mr-20 font-bold"},[r("p",null,"Name"),r("p",null,"Register at"),r("p",null,"Messages")],-1),Pe={class:"w-50"};function ze(e,t,s,d,i,o){return a(),l("div",Te,[r("button",{class:"mb-3 bg-m4 text-m1 px-2 py-1 rounded shadow shadow-yellow-400",onClick:t[0]||(t[0]=(...u)=>o.logout&&o.logout(...u))},"Logout"),r("div",Fe,[Je,r("div",Pe,[r("p",null,h(e.target.name),1),r("p",null,h(o.onlineAt.day+" "+o.onlineAt.month+" "+o.onlineAt.year),1),r("p",null,h(e.target.count),1)])])])}const He={data:()=>({target:{}}),computed:{targetUserID(){return this.$route.params.id},onlineAt(){let e=new Date(this.target.onlineAt),t=e.getDate(),d=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],i=e.getFullYear();return{day:t,month:d,year:i}}},methods:{logout(){this.$router.push("/login")}},mounted(){this.getOne("users/"+this.targetUserID).then(e=>{this.target=e})}};var qe=p(He,[["render",ze]]);const v=e=>(N("data-v-592ea2c6"),e=e(),R(),e),We=_+"#loader",Ye=_+"#lock",Ge=_+"#unlock",S=_+"#delete",E=_+"#edit",Qe={key:0,class:"loader"},Xe=v(()=>r("svg",{class:"w-8 h-8"},[r("use",{href:We})],-1)),Ze=[Xe],et={key:1,class:"chat"},tt={key:0,class:"chat-icon"},st={key:0,href:Ye},ot={key:1,href:Ge},rt=v(()=>r("use",{href:S},null,-1)),nt=[rt],it=v(()=>r("use",{href:E},null,-1)),at=[it],lt={class:"message-list"},ut={class:"fxc"},dt={key:0,class:"edit-button"},ht=["onClick"],mt=v(()=>r("use",{href:E},null,-1)),ct=[mt],_t=["onClick"],pt=v(()=>r("use",{href:S},null,-1)),gt=[pt],ft={class:"message-text"};function vt(e,t,s,d,i,o){const u=g("router-link");return e.isLoading?(a(),l("div",Qe,Ze)):(a(),l("div",et,[e.isAdmin?(a(),l("div",tt,[(a(),l("svg",{class:"w-4 h-4 mr-2",onClick:t[0]||(t[0]=(...n)=>o.lockRoom&&o.lockRoom(...n)),fill:"white"},[e.roomInfo.private?(a(),l("use",ot)):(a(),l("use",st))])),(a(),l("svg",{class:"w-4 h-4 mr-2",onClick:t[1]||(t[1]=(...n)=>o.deleteChat&&o.deleteChat(...n)),fill:"white"},nt)),(a(),l("svg",{class:"w-4 h-4",onClick:t[2]||(t[2]=n=>e.editRoomName=!e.editRoomName),fill:"white"},at)),e.editRoomName?(a(),l("input",{key:0,class:"message-input absolute",onKeydown:t[3]||(t[3]=b(n=>o.setRoomName(n.target.value),["enter"]))},null,32)):I("",!0)])):I("",!0),r("ul",lt,[(a(!0),l(k,null,A(e.messages,(n,C)=>(a(),l("li",{class:G(["message",n.userID==e.userID&&"ml-auto"])},[r("div",ut,[f(u,{class:"message-user",to:"/user/"+n.userID},{default:y(()=>[$(h(n.userName),1)]),_:2},1032,["to"]),n.userID==e.userID?(a(),l("div",dt,[(a(),l("svg",{class:"mr-2",onClick:V=>o.fixMessage(n)},ct,8,ht)),(a(),l("svg",{onClick:V=>o.deleteMessage(n)},gt,8,_t))])):I("",!0)]),r("div",ft,h(n.text),1)],2))),256))]),D(r("input",{class:"message-input","onUpdate:modelValue":t[4]||(t[4]=n=>e.text=n),placeholder:"Type message...",onKeydown:t[5]||(t[5]=b((...n)=>o.handleEnter&&o.handleEnter(...n),["enter"]))},null,544),[[w,e.text]])]))}const yt={data:()=>({roomInfo:{},text:"",messages:{},isLoading:!1,isAdmin:!1,isEdit:!1,message:{},hover:[],editRoomName:!1,counter:0}),computed:{getFullRoom(){let e;return this.getOne("rooms/"+this.roomID).then(t=>e=t),e}},methods:{getMessages(){this.isLoading=!0;const e=t=>{const s=document.getElementsByClassName(t);s[0].scrollTop=s[0].scrollHeight};U(m(c,"rooms/"+this.roomID),t=>{let s=t.val();s?(this.roomInfo=s._info,this.isAdmin=Object.keys(s._info.users)[0]==this.userID,this.messages=Object.keys(s).map(d=>K(L({},s[d]),{id:d})),this.messages.pop()):this.messages=[{text:"No messages yet!",user:"Admin"}],setTimeout(()=>e("message-list"),10)}),this.isLoading=!1},deleteChat(){this.removeOne("rooms/"+this.roomID).then(e=>this.$router.push("/"))},lockRoom(){this.updateByKey(`rooms/${this.roomID}`,"_info",{private:!this.roomInfo.private})},handleEnter(){this.isEdit&&this.text?this.editMessage():this.sendMessage()},sendMessage(e=this.text,t=this.userID,s=this.userName){if(this.text){let d=new Date,i=this.add("rooms/"+this.roomID,{text:e,userID:t,date:d,userName:s});this.updateByKey("users/"+this.userID+"/messages",i,{text:e,userID:t,date:d,userName:s}),this.$store.commit("countMessage"),this.updateByKey("users/",this.userID,{count:this.$store.state.user.count}),this.text=""}},editMessage(){const{userID:e,id:t}=this.message;this.updateByKey(`rooms/${this.roomID}`,t,{text:this.text}),this.updateByKey(`users/${e}/messages`,t,{text:this.text}),this.text="",this.isEdit=!1},deleteMessage({id:e}){this.removeOne(`rooms/${this.roomID}/${e}`)},fixMessage(e){this.message=e,this.text=e.text,this.isEdit=!0},setRoomName(e){this.updateByKey(`rooms/${this.roomID}`,"_info",{name:e}),this.editRoomName=!1}},mounted(){this.getMessages()}};var $t=p(yt,[["render",vt],["__scopeId","data-v-592ea2c6"]]);var It={data:()=>({}),computed:{userName(){var e;return(e=this.$store.state.user)==null?void 0:e.name},userID(){return this.$store.state.user.id},roomID(){var e;return(e=this.$route.params)==null?void 0:e.roomID},lsUser:{get(){return JSON.parse(localStorage.getItem("chat--user"))||null},set(e){localStorage.setItem("chat--user",JSON.stringify(e))}}},watch:{},methods:{getOne(e,t){return Q(m(c,e)).then(s=>s.val())},add(e,t){return j(m(c,e),t).key},getKey(e){return j(m(c,e)).key},updateByKey(e,t,s){X(m(c,e+"/"+t),s)},removeOne(e){return Z(m(c,e))},setOne(e,t,s){return ee(m(c,e+t),s)}}};const bt=[{path:"/",component:Ae},{path:"/login",component:Ve},{path:"/user/:id",component:qe},{path:"/user",redirect:"/"},{path:"/room",redirect:"/"},{path:"/room/:roomID",component:$t}],kt=te({history:se(),routes:bt});oe(pe).use(kt).use(ne).mixin(It).mount("#app");
